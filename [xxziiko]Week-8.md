# Chapter 16
<br/>
<br/>
<br/>
<br/>


## 좋은 타임라인의 원칙
1. 타임라인은 적을수록 이해하기 쉽다.
2. 타임라인은 짧을수록 이해하기 쉽다.
3. 공유하는 자원이 적을수록 이해하기 쉽다.
4. 자원을 공유한다면 서로 조율해야 한다.
5. 시간을 일급으로 다룬다.

<br/>
<br/>

## 버그가 생기는 원인?
- DOM 자원을 공유하게 되면 액션들은 '실행 순서'가 중요해짐. -> 잘못된 실행순서에 의해서 버그 발생
- **DOM이 업데이트 되는 순서를 보장해야 한다.**

<br/>
<br/>

## Queue(큐)
- 들어온 순서대로 나오는 데이터 구조 
- 여러 타임라인에 있는 액션 순서를 조율하기 위해 사용
- 모든 작업은 같은 타임라인에서 처리되기 때문에 순서가 관리됨

**동시성 기본형** 이란?
- 자원을 안전하게 공유할 수 있는 재사용 가능한 코드

  <br/>
  <br/>

## 자바스크립트에서 큐 만들기
- 자바스크립트는 큐 자료구조가 없기 때문에 직접 만들면서 큐 구조 이해해보기


1. 큐에서 처리할 작업을 큐에 넣는 함수 만들기 (배열에 push)
2. 큐에 있는 첫번째 항목을 실행하는 함수 만들기 (shift 메소드, setTimeout 활용)
3. 두 번째 타임라인이 첫 번째 타임라인과 동시에 실행되는 것 막기
4. 다음 작업 시작하는 콜백함수 만들기
5. 항목이 없을때 멈추게 하기
6. 변수와 함수를 함수 범위로 넣기
     - 작성했던 코드의 모든 전역변수를 Queue() 라는 함수 범위에 넣어 밖에서 변경하지 못하도록 하기.
    
  <br/>
  <br/>

## 문제가 예상되면 타임라인 다이어그램을 살펴보기
- 타이밍에 관한 버그를 확인하려면 타임라인 다이어그램 그리기
- 액션을 사용하는 프로그래밍을 하고 있다면 타임라인 다이어그램 그리기
- 타임라인 다이어그램은 모든 실행 가능한 순서를 포함해 소프트웨어가 어떻게 동작하는지 이해하는 데 쓸 수 있는 유용한 도구


<br/>
<br/>


## 요점정리
- 타이밍, 액션에 관한 문제는 테스트에서 확인하지 못할 수 있으니 타임라인 다이어그램을 그려 분석하고 문제를 확인하자.
- 자원 공유 문제가 있을 때 현실에서 해결방법을 찾아보는 것도 도움이 된다.
- 재사용 가능한 도구를 만들면 자원 공유에 도움이 된다. 자원 공유를 위한 도구를 **동시성 기본형** 이라고 부른다.
  동시성 기본형을 사용하면 코드가 더 깨끗하고 단순해진다.
- 동시성 기본형은 액션을 고차 함수로 받는다. 이 고차함수는 액션에 슈퍼파워를 준다.

<br/>
<br/>

# Chapter 17
<br/>
<br/>
<br/>
<br/>

## 타임라인 다이어그램을 통해 버그를 확인하고 리팩토링 하기
1. 액션을 확인하기
2. 각 액션을 그리기
3. 다이어그램 단순화하여 공유자원 확인
   - 자바스크립트 스레드 모델에서 단순화 하기 위한 단계
     1. 하나의 타임라인에 있는 모든 액션을 하나로 통합
     2. 타임라인이 끝나는 곳에서 새로운 타임라인이 하나만 생긴다면 통합
4. 공유자원에서 실행 가능한 순서 분석
5. 동시성 기본형을 만들어 항상 올바른 순서로 동작하게 만들기(병렬 콜백) -> 재사용 가능한 기본형 만들기
6. 올바르고 빠르게 동작하는지 확인하기


<br/>
<br/>

## 자바스크립트의 시간모델 
1. 순차적 구문은 순서대로 실행된다.
2. 두 타임라인에 있는 단계는 왼쪽이 먼저 실행되거나, 오른쪽이 먼저 실행될 수 있다.
3. 비동기 이벤트는 새로운 타임라인에서 실행된다.
4. 액션은 호출할 때마다 실행된다.

- 암묵적 시간모델이 애플리케이션에서 필요한 실행 방식과 딱 맞을 수 없기 때문에 필요한 실행 방식에 가깝게 새로운 시간 모델을 만들자.
- 예) 비동기 콜백을 사용할 때 새로운 타임라인을 만들지 않도록 큐를 만들었음, 여러번 호출 해도 한 번만 실행하는 액션을 만들기 위해 동시성 기본형을 만들었음


<br/>
<br/>


## 요점정리
- 함수형 개발자는 언어가 제공하는 암묵적 시간 모델 대신 새로운 시간 모델을 만들어 사용한다.
  새로운 모델은 해결하려고 하는 문제를 푸는데 도움을 준다.
- 명시적 시간 모델은 종종 일급 값으로 만들자. 일급 값으로 만든 시간 모델은 프로그래밍 언어를 사용해 시간을 다룰 수 있다.
- 타임라인을 조율하기 위해 동시성 기본형을 만들 수 있다. 가능한 순서를 제한해 항상 올바른 결과를 보장하자.
- 타임라인을 나누는 것도 타임라인을 조율하는 방법 중 하나이다. 컷은 모든 타임라인의 작업이 끝날 때까지 기다렸다가 새로운 타임라인을 시작할 수 있도록 하자.

    

